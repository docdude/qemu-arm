--- hw/audio/wm8750.c
+++ hw/audio/wm8750.c
@@ -9,12 +9,13 @@
 
 #include "hw/hw.h"
 #include "hw/i2c.h"
+#include "hw/audio.h"
 #include "audio/audio.h"
 
 #define IN_PORT_N	3
 #define OUT_PORT_N	3
 
-#define CODEC		"wm8750"
+#define TYPE_WM8750 "wm8750"
 
 typedef struct {
     int adc;
@@ -24,7 +25,7 @@
 } WMRate;
 
 typedef struct {
-    I2CSlave i2c;
+    AudioCodecState parent;
     uint8_t i2c_data[2];
     int i2c_len;
     QEMUSoundCard card;
@@ -259,7 +263,7 @@
 
 static void wm8750_reset(I2CSlave *i2c)
 {
-    WM8750State *s = (WM8750State *) i2c;
+    WM8750State *s = WM8750(i2c);
     s->rate = &wm_rate_table[0];
     s->enable = 0;
     wm8750_clk_update(s, 1);
@@ -302,7 +306,7 @@
 
 static void wm8750_event(I2CSlave *i2c, enum i2c_event event)
 {
-    WM8750State *s = (WM8750State *) i2c;
+    WM8750State *s = WM8750(i2c);
 
     switch (event) {
     case I2C_START_SEND:
@@ -359,7 +363,7 @@
 
 static int wm8750_tx(I2CSlave *i2c, uint8_t data)
 {
-    WM8750State *s = (WM8750State *) i2c;
+    WM8750State *s = WM8750(i2c);
     uint8_t cmd;
     uint16_t value;
 
@@ -545,7 +549,7 @@
         break;
 
     case WM8750_RESET:	/* Reset */
-        wm8750_reset(&s->i2c);
+        wm8750_reset(I2C_SLAVE(&s->parent));
         break;
 
 #ifdef VERBOSE
@@ -607,42 +611,31 @@
         VMSTATE_UINT8(format, WM8750State),
         VMSTATE_UINT8(power, WM8750State),
         VMSTATE_UINT8(rate_vmstate, WM8750State),
-        VMSTATE_I2C_SLAVE(i2c, WM8750State),
         VMSTATE_END_OF_LIST()
     }
 };
 
 static int wm8750_init(I2CSlave *i2c)
 {
-    WM8750State *s = FROM_I2C_SLAVE(WM8750State, i2c);
+    WM8750State *s = WM8750(i2c);
 
-    AUD_register_card(CODEC, &s->card);
-    wm8750_reset(&s->i2c);
+    AUD_register_card(TYPE_WM8750, &s->card);
+    wm8750_reset(I2C_SLAVE(&s->parent));
 
     return 0;
 }
 
-#if 0
-static void wm8750_fini(I2CSlave *i2c)
-{
-    WM8750State *s = (WM8750State *) i2c;
-    wm8750_reset(&s->i2c);
-    AUD_remove_card(&s->card);
-    g_free(s);
-}
-#endif
-
-void wm8750_data_req_set(DeviceState *dev,
+static void wm8750_data_req_set(DeviceState *dev,
                 void (*data_req)(void *, int, int), void *opaque)
 {
-    WM8750State *s = FROM_I2C_SLAVE(WM8750State, I2C_SLAVE(dev));
+    WM8750State *s = WM8750(dev);
     s->data_req = data_req;
     s->opaque = opaque;
 }
 
-void wm8750_dac_dat(void *opaque, uint32_t sample)
+static void wm8750_dac_dat(void *opaque, uint32_t sample)
 {
-    WM8750State *s = (WM8750State *) opaque;
+    WM8750State *s = WM8750(opaque);
 
     *(uint32_t *) &s->data_out[s->idx_out] = sample;
     s->req_out -= 4;
@@ -713,8 +714,8 @@
 }
 
 static const TypeInfo wm8750_info = {
-    .name          = "wm8750",
-    .parent        = TYPE_I2C_SLAVE,
+    .name          = TYPE_WM8750,
+    .parent        = TYPE_AUDIO_CODEC,
     .instance_size = sizeof(WM8750State),
     .class_init    = wm8750_class_init,
 };
